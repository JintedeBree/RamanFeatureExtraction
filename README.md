# RamanFeatureExtraction
A MATLAB based Raman Feature extraction app which can extract morphological and chemical characteristics from microcalcifications present in a Raman microspectroscopic raster scan of 40x40 (56x56 um). This script is written by Jinte de Bree as part of a bachelor thesis 'Hyperspectral Raman imaging of breast tissue microcalcifications: differentiating benign and malignant pathologies', University of Twente, the Netherlands.

FeatureExtractionPipeline.mlapp is the main app, which calls the functions present in folder 'FunctionsRFE'. An explanation of how the app should be used to extract characteristics from the Raman microscopic raster scan:

Step 1 'Upload+Filter': The user starts with pressing 'Upload Raman Data' and should select a asc, txt or bin file with a 1601x1600 matrix, with the first column containing the wavenumber axis and the corresponding Raman spectra of the individual pixels in the raster scan. Then, the user should select the preproccessing options that are desired. Even when no options are selected, the user should finish by pressing 'Preproccesing'. When the lamp turns green, the user can go to the next tab 'Size+Shape'.

Step 2 'Size+Shape': the user should press 'Plot intensity map (960 peak)'. Before 'Plot Binary map' is pressed, the user should determine if the threshold is set manually or automatically (default). Pressing 'Plot segmented binary map' is an option, and should only be pressed when the user wants to separate overlapping microcalcifications in the binary map. The user can choose for a pixel connectivity of four (default) or eight to determine individual microcalcifications in the (segmented) binary map. Lastly, the 'properties calcification' should always be pushed and values of the size+shape parameters of each microcalcification will show up in the table. When the lamp turns green, the user can go to the next tab 'Carbonate content'.

Step 3 'Carbonate content': the user should always press the following 3 buttons in the same order: 'visualise carbonate content', 'properties calcifications' and 'switch visualisation'. Values of the carbonate content parameters of each microcalcification will show up in the table. When the lamp turns green, the user is able to select the heatmap that they want to analyze. The user should always press 'switch visualisation' after a new option of heatmap is selected. Also when the switch of the Rsquared threshold is switched from automatic (default) to manual, the 'switch visualisation' should be pressed. This will allow the user to analyse all the different heatmaps and click on the pixels in the heatmaps to see the phosphate (960) and carbonate (1070) peak of the corresponding pixel. As long as the lamp is green, the user can go to the next tab 'Protein content'.

Step 4 'Protein content': the user should always press the following 3 buttons in the same order: 'visualise protein content', 'properties calcifications' and 'switch visualisation'. Values of the protein content parameters of each microcalcification will show up in the table. When the lamp turns green, the user is able to select the heatmap that they want to analyze. The user should always press 'switch visualisation' after a new option of heatmap is selected. This will allow the user to analyse all the different heatmaps and click on the pixels in the heatmaps to see the background corrected phenylalanine (1004), Ch2/CH3 (1445), Amide I peaks (1650) of the corresponding pixel. Also the whole spectrum of the corresponding pixel is plotted with red being the background spectrum, blue being the original Raman spectrum of the pixel and black being the background corrected Raman spectrum of the pixel. As long as the lamp is green, the user can go to the next tab 'Crystallinity + Magnesium content'.

Step 5 'Crystallinity + Magnesium content': the user should always press the following 3 buttons in the same order: 'visualise carbonate content', 'properties calcifications' and 'switch visualisation'. Values of the crystallinity + Magnesium content parameters of each microcalcification will show up in the table. When the lamp turns green, the user is able to select the heatmap that they want to analyze. The user can specify the peak positions for the phosphate and carbonate peaks, which default to 960 and 1070, respectively. The user should always press 'switch visualisation' after a new option of heatmap is selected. This will allow the user to analyse all the different heatmaps and click on the pixels in the heatmaps to see the phosphate (960) and carbonate (1070) peak of the corresponding pixel. As long as the lamp is green, the user can go to the next tab 'Export'.

Step 6 'Export': When the user has followed all the previous mentioned steps, the user can click 'Export properties (manually)' and an excellsheet will be exported containing all the microcalcifications and their corresponding values for the parameters.

Instead of following these instructions manually, the user can also press 'Export properties of a single file'. The user only have to select the asc, txt or bin file with a 1601x1600 matrix and the app will extract the properties automatically. The user can also press 'Export properties of patient folder'. The user only has to select a folder containing asc, txt or bin files with a 1601x1600 matrix. It should be noted that all the default settings are used for this automatic feature extraction pipeline and a baseline correction, truncation and area normailization (after substracting properties) are selected in this automatic pipeline. If the user want to change the settings of the automatic pipeline, this can be done by changin the callback codes of the buttons.

Bonus step 'Overview spectra': The user can plot the intesity map of the phosphate (960) peak by pressing 'Plot intensity', with default spectrum range 955-965. The user can click on the intensity map to see the spectrum of the corresponding pixel. If the user want to switch from the filtered (default) to the unfiltered spectra, the user should flip the switch and again press 'Plot intensity'.

The FunctionsRFe folder contains all the functions needed to run the app. A detailed description of each function is included in their script. The FunctionsRFE folder should be in the same folder as the FeatureExtractionPipeline.mlapp.

The TestFiles folder contains four example .asc files which can be used to test the app.

The Results_benignVdcisVidcVcombi.csv file contains the result of the mean and standard deviation values of each parameter calculated in the app. The mean and standard deviation for each parameter are calculated for the different subgroups: benign, DCIS, IDC, and DCIS and IDC.

The Results_benignVmalignant.csv file contains the result of the mean and standard deviation values of each parameter calculated in the app. The mean and standard deviation for each parameter are calculated for the different groups: benign, and malignant.

Correspondation to jinte@familiedebree.nl
